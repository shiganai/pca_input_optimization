function velocity = get_velocity_fromPCA_005(pcaScore_ratio, row_num, col_num)

% step_num = 3;
% Para.velocity_variety = linspace(-1,1,step_num);
% vv = Para.velocity_variety;
% 
% [x1, x2, x3, x4, x5, x6, x7, y1, y2, y3, y4, y5, y6, y7] = ...
%     ndgrid(vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv);
% 
% load('Para')
% 
% target_performance = 2;
% target_vm = Para.velocity_matrix_NaN(Para.performance < target_performance, :);
% target_performance = Para.performance(Para.performance < target_performance);
% target_vm = unique(target_vm, 'rows');
% 
% [coeff_vm, score_vm, latent_vm, ~, ~, mu_vm] = pca(target_vm, 'Weights', 1./(1 + target_performance), 'Centered', true);

coeff_vm = [
   -0.0965    0.0567   -0.1528   -0.1577    0.0038         0         0    0.0466    0.7071    0.1693   -0.3503   -0.2147    0.4218   -0.2484
   -0.0965    0.0567   -0.1528   -0.1577    0.0038   -0.0000   -0.0000    0.0466   -0.7071    0.1693   -0.3503   -0.2147    0.4218   -0.2484
    0.3155   -0.1713    0.2337    0.2066   -0.6963    0.0000    0.0000   -0.1877   -0.0000   -0.1377    0.2335   -0.1528    0.3108   -0.2458
    0.3297   -0.1894    0.2351    0.1147    0.7056   -0.0000   -0.0000   -0.0390   -0.0000   -0.1575    0.2897   -0.1604    0.3035   -0.2470
   -0.3809    0.2299    0.0198    0.1395    0.0041    0.2685    0.6541    0.0436   -0.0000   -0.2294    0.1745    0.3319    0.2568   -0.1452
   -0.3809    0.2299    0.0198    0.1395    0.0041   -0.2685   -0.6541    0.0436   -0.0000   -0.2294    0.1745    0.3319    0.2568   -0.1452
    0.0873   -0.0656    0.0179   -0.1548   -0.0110   -0.0000    0.0000   -0.0163    0.0000    0.7853    0.3631    0.4258    0.0876   -0.1607
   -0.2387   -0.5539    0.0806    0.0339    0.0689   -0.0000    0.0000   -0.5543   -0.0000   -0.0018   -0.2414    0.2450    0.2601    0.3614
    0.4925    0.6264    0.0148    0.0254    0.0470   -0.0000    0.0000   -0.3075   -0.0000    0.0048   -0.1687    0.2120    0.2545    0.3596
    0.1266   -0.1923    0.2608    0.2967   -0.0477   -0.0000   -0.0000    0.7133    0.0000    0.0873   -0.2170    0.1714    0.2633    0.3556
    0.0124   -0.0719   -0.2610   -0.3584   -0.0513   -0.6541    0.2685    0.1220    0.0000   -0.1341    0.3288   -0.0946    0.2292    0.3049
    0.0124   -0.0719   -0.2610   -0.3584   -0.0513    0.6541   -0.2685    0.1220   -0.0000   -0.1341    0.3288   -0.0946    0.2292    0.3049
   -0.2047    0.1088   -0.3259    0.6493    0.0508   -0.0000   -0.0000   -0.1059    0.0000    0.3198    0.2435   -0.4139    0.0869    0.2536
   -0.3428    0.2449    0.7247   -0.2514   -0.0084   -0.0000   -0.0000   -0.0576    0.0000    0.1759    0.1193   -0.3655    0.0383    0.2247
   ];

mu_vm = [
   -0.9286   -0.9286   -0.3036    0.6786    0.6250   -0.3750   -0.9286    0.5000    0.3036    0.8571    0.8571    0.8571    0.8036    0.7321
    ];

pcaScore_ratio = reshape(pcaScore_ratio, 1, 7 * 2);

pcaScore_max = sum(abs(coeff_vm),1);
pcaScore = pcaScore_max .* pcaScore_ratio;

velocity = pcaScore * coeff_vm' + mu_vm;
velocity = reshape(velocity, row_num, col_num);

velocity(velocity > 1) = 1;
velocity(velocity < -1) = -1;

end

