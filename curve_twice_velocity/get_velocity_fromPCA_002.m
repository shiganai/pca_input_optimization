function velocity = get_velocity_fromPCA_002(pcaScore_ratio, row_num, col_num)

% step_num = 3;
% Para.velocity_variety = linspace(-1,1,step_num);
% vv = Para.velocity_variety;
% 
% [x1, x2, x3, x4, x5, x6, x7, y1, y2, y3, y4, y5, y6, y7] = ...
%     ndgrid(vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv);
% 
% load('Para')
% 
% target_performance = 10;
% target_vm = Para.velocity_matrix_NaN(Para.performance < target_performance, :);
% target_performance = Para.performance(Para.performance < target_performance);
% target_vm = unique(target_vm, 'rows');
% 
% [coeff_vm, score_vm, latent_vm, ~, ~, mu_vm] = pca(target_vm, 'Weights', 1./(1 + target_performance), 'Centered', false);

coeff_vm = [
    0.5652   -0.1068    0.1016   -0.0169   -0.0013   -0.0900    0.1236    0.0018    0.2597   -0.2606    0.4992   -0.3935   -0.0649    0.3025
    0.4124   -0.0896    0.0768   -0.0080   -0.1045    0.1123    0.2078   -0.6731   -0.3239    0.1573   -0.2236    0.2403    0.0669    0.2332
    0.3200   -0.0991    0.0837    0.0023   -0.2519    0.2887    0.1691    0.6882   -0.2061   -0.0743   -0.1606    0.3389    0.0872    0.1881
    0.1240   -0.0123    0.1062    0.1635    0.8119   -0.2968   -0.0544    0.0946   -0.0984   -0.1219    0.0155    0.3771    0.0560    0.1306
    0.0413    0.0019   -0.0764   -0.5514   -0.3021   -0.6016   -0.1289    0.0029    0.1793   -0.0030    0.0558    0.4194   -0.0071    0.0861
   -0.0293    0.0218   -0.0329    0.6981   -0.2685   -0.0866    0.0601   -0.0946    0.5155   -0.0072    0.0214    0.3799   -0.0638    0.0581
   -0.0037   -0.0066   -0.0680   -0.4010    0.2520    0.6055   -0.0362   -0.1295    0.5437   -0.1073   -0.0388    0.2645   -0.0806    0.0333
   -0.5274   -0.0296    0.0845   -0.0259   -0.0495    0.0726    0.1753   -0.0471   -0.2314   -0.1711    0.2365    0.0945   -0.4231    0.5881
    0.1711    0.3203   -0.3914    0.0709    0.0505    0.0269   -0.4684    0.1046    0.0354    0.3811   -0.1877   -0.1583   -0.1467    0.4980
   -0.1930   -0.4623    0.3744   -0.0459    0.0530   -0.1403    0.0460    0.0626    0.3112    0.2113   -0.4278   -0.2613    0.2582    0.3447
   -0.1164    0.5764   -0.1394   -0.0422   -0.0046   -0.0735    0.3520   -0.0374    0.0794   -0.3852   -0.2227   -0.1163    0.4857    0.2204
   -0.1240   -0.4353   -0.3769    0.0929   -0.0860    0.1181   -0.4195   -0.1059   -0.1460   -0.3285    0.1850    0.0620    0.4987    0.1413
   -0.0848    0.3360    0.5585   -0.0107   -0.0777    0.1633   -0.2791   -0.0226   -0.0250    0.3019    0.4271    0.1324    0.3971    0.0855
   -0.0968   -0.1350   -0.4244   -0.0485    0.1351   -0.0005    0.5083    0.0917    0.0454    0.5557    0.3595    0.0549    0.2460    0.0356
   ];

mu_vm = [
     0     0     0     0     0     0     0     0     0     0     0     0     0     0
    ];

pcaScore_ratio = reshape(pcaScore_ratio, 1, 7 * 2);

pcaScore_max = sum(abs(coeff_vm),1);
pcaScore = pcaScore_max .* pcaScore_ratio;

velocity = pcaScore * coeff_vm' + mu_vm;
velocity = reshape(velocity, row_num, col_num);

velocity(velocity > 1) = 1;
velocity(velocity < -1) = -1;

end

