function velocity = get_velocity_fromPCA_004(pcaScore_ratio, row_num, col_num)

% step_num = 3;
% Para.velocity_variety = linspace(-1,1,step_num);
% vv = Para.velocity_variety;
% 
% [x1, x2, x3, x4, x5, x6, x7, y1, y2, y3, y4, y5, y6, y7] = ...
%     ndgrid(vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv, vv);
% 
% load('Para')
% 
% target_performance = 3;
% target_vm = Para.velocity_matrix_NaN(Para.performance < target_performance, :);
% target_performance = Para.performance(Para.performance < target_performance);
% target_vm = unique(target_vm, 'rows');
% 
% [coeff_vm, score_vm, latent_vm, ~, ~, mu_vm] = pca(target_vm, 'Weights', 1./(1 + target_performance), 'Centered', true);

coeff_vm = [
    0.1147   -0.0050   -0.0073   -0.1719   -0.0875   -0.0379    0.0221   -0.0677    0.1008    0.7247   -0.2698   -0.0945    0.5154   -0.2457
    0.1113    0.0082    0.0278   -0.1754   -0.1092   -0.0418    0.0353   -0.0146    0.1234   -0.6847   -0.3601   -0.0926    0.5087   -0.2446
   -0.3190   -0.0312    0.0198    0.3468   -0.0522    0.6101   -0.3998   -0.0880   -0.1114   -0.0231    0.1896    0.1848    0.2953   -0.2526
   -0.3428   -0.1002   -0.0561    0.3291    0.1878   -0.5627    0.3304    0.0126   -0.1801   -0.0215    0.2693    0.2191    0.2898   -0.2498
    0.2956    0.0764    0.0809   -0.3680    0.5800    0.0638   -0.1166   -0.0619   -0.0029   -0.0476    0.5718   -0.1558    0.2233   -0.0595
    0.5370    0.3411   -0.2834    0.4336   -0.3644   -0.0087    0.0820    0.2199    0.0171   -0.0122    0.3144   -0.1562    0.1115   -0.0536
   -0.1381   -0.0845    0.6783   -0.1472   -0.3455    0.0270    0.1180    0.5053   -0.0569    0.0248    0.2497   -0.1763    0.0402   -0.0620
    0.1941   -0.5546   -0.0078    0.1859    0.0119    0.0279   -0.0193   -0.0627   -0.5206   -0.0142   -0.0701   -0.3121    0.2417    0.4277
   -0.3959    0.6784   -0.0112   -0.0655    0.0121   -0.0229    0.0090   -0.0533   -0.2702    0.0036   -0.0614   -0.2701    0.2298    0.4154
   -0.1606   -0.1470   -0.0130    0.3026    0.2526    0.0325   -0.0072    0.2730    0.7009    0.0152   -0.0112   -0.1508    0.2156    0.4008
    0.0032   -0.0737   -0.0001   -0.1863   -0.3976   -0.4219   -0.5634   -0.1670    0.1351   -0.0185    0.2500    0.2886    0.1642    0.2951
    0.0073   -0.0672   -0.0095   -0.1810   -0.2513    0.3249    0.6135   -0.3541    0.1385   -0.0186    0.2446    0.3148    0.1695    0.2916
    0.1420    0.0651   -0.1627   -0.1641    0.1734    0.1085   -0.0082    0.6108   -0.2315    0.0238   -0.1663    0.5985    0.1613    0.2029
    0.3464    0.2368    0.6495    0.3756    0.1962   -0.0734   -0.0269   -0.2688   -0.0020    0.0169   -0.2052    0.2946    0.0331    0.1180
   ];

mu_vm = [
   -0.9151   -0.9151   -0.3302    0.6462    0.6934   -0.0825   -0.6816    0.4764    0.3491    0.8255    0.8255    0.8349    0.8514    0.5684
    ];

pcaScore_ratio = reshape(pcaScore_ratio, 1, 7 * 2);

pcaScore_max = sum(abs(coeff_vm),1);
pcaScore = pcaScore_max .* pcaScore_ratio;

velocity = pcaScore * coeff_vm' + mu_vm;
velocity = reshape(velocity, row_num, col_num);

velocity(velocity > 1) = 1;
velocity(velocity < -1) = -1;

end

